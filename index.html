<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Linux Treasure Hunt — Levels 1-5</title>
<style>
:root{--bg:#071225;--panel:#061426;--accent:#ffd166;--muted:#9ca3af;--good:#4ade80;--bad:#f87171}
body{margin:0;background:linear-gradient(180deg,var(--bg) 0%, #021018 100%);color:#cbd5e1;font-family:ui-monospace,monospace}
.wrap{max-width:1100px;margin:18px auto;padding:18px}
header{display:flex;align-items:center;justify-content:space-between;gap:12px}
h1{margin:0;color:var(--accent)}
.grid{display:grid;grid-template-columns:1fr 360px;gap:16px;margin-top:12px}
.panel{background:var(--panel);padding:12px;border-radius:10px;box-shadow:0 6px 24px rgba(2,6,23,.6)}
.story{color:var(--muted);line-height:1.45}
.terminal{background:#000;border-radius:8px;padding:12px;height:420px;overflow:auto;color:#9ae6b4}
.prompt{display:flex;gap:8px;align-items:center;margin-top:8px}
input, .cmdline{flex:1;background:transparent;border:0;color:var(--muted);outline:none;font:inherit}
.controls{display:flex;gap:8px;margin-top:10px}
button{background:#06202a;border:1px solid rgba(255,255,255,.04);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
.status{margin-top:10px;font-weight:700;color:var(--accent)}
.hint{margin-top:8px;color:var(--muted)}
.command{color:#a5f3fc}
.success{color:var(--good)}
.error{color:var(--bad)}
.progress{height:10px;background:#021018;border-radius:999px;overflow:hidden;margin-top:8px}
.progress > i{display:block;height:100%;background:linear-gradient(90deg,#ffd166,#8ef5b6);width:0%}
.map{font-size:13px;color:var(--muted);line-height:1.6}
.map .done{color:var(--good)}
.footer{margin-top:12px;color:var(--muted);font-size:13px}
.small{font-size:13px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
<header>
<h1>🏴‍☠️ Linux Treasure Hunt — Levels 1-5</h1>
<div class="small">Interactive Linux learning game</div>
</header>
<div class="grid">
<div class="panel">
<div class="story" id="story">Break into the vault and retrieve the treasure using Linux commands.</div>
<div id="terminal" class="terminal" aria-live="polite"></div>
<form id="form" class="prompt" autocomplete="off">
<div style="color:var(--muted)">$</div>
<input id="input" class="cmdline" placeholder="Type a command (help)" autofocus>
</form>
<div class="controls">
<button id="btn-help" type="button">Help</button>
<button id="btn-clear" type="button">Clear</button>
</div>
<div id="status" class="status">Level 1: Navigate to <code>/vault/entrance</code></div>
<div class="hint">Commands: <span class="command">help</span>, <span class="command">pwd</span>, <span class="command">ls</span>, <span class="command">cd</span>, <span class="command">touch</span>, <span class="command">rm</span>, <span class="command">cat</span>, <span class="command">chmod</span>, <span class="command">scp</span></div>
<div class="progress"><i id="progress-bar"></i></div>
<div class="footer">Use ↑/↓ for history and Tab for autocomplete.</div>
</div>
<div class="panel">
<h3 style="margin:0;color:var(--accent)">Mission Map</h3>
<div class="map" id="map">
<div id="m1">[ ] Level 1 — Break In</div>
<div id="m2">[ ] Level 2 — Crack the Lock</div>
<div id="m3">[ ] Level 3 — Read the Map</div>
<div id="m4">[ ] Level 4 — Disable Security</div>
<div id="m5">[ ] Level 5 — Escape with Treasure</div>
</div>
</div>
</div>
<script>
(function(){
const fs = {
'/':['home','vault'],
'/home':['thief'],
'/vault':['entrance','documents','chamber'],
'/vault/entrance':['alarm.txt'],
'/vault/documents':['map.txt'],
'/vault/chamber':['disable.sh','treasure.dat'],
'/home/thief':['safehouse']
};
const fileContents = {
'/vault/documents/map.txt':'Treasure chamber is /vault/chamber'
};
let state = {cwd:'/',level:1,filePermissions:{}};
const term=document.getElementById('terminal');
const input=document.getElementById('input');
const status=document.getElementById('status');
const mapEls=[document.getElementById('m1'),document.getElementById('m2'),document.getElementById('m3'),document.getElementById('m4'),document.getElementById('m5')];

function pushLine(t,c){let d=document.createElement('div');if(c)d.className=c;d.textContent=t;term.appendChild(d);term.scrollTop=term.scrollHeight;}
function normalizePath(p){if(!p)return state.cwd;if(p.startsWith('/')){p=p.replace(/\\/+/g,'/');if(p!=='/'&&p.endsWith('/'))p=p.replace(/\\/+$/,'');return p||'/';}if(p==='..'){if(state.cwd==='/')return'/';let a=state.cwd.split('/').filter(Boolean);a.pop();return'/'+a.join('/')||'/';}return state.cwd==='/'?`/${p}`:`${state.cwd}/${p}`;}
function updateUI(){const pct=Math.min((state.level-1)/5*100,100);document.getElementById('progress-bar').style.width=pct+'%';const lbls=['Break In','Crack the Lock','Read the Map','Disable Security','Escape with Treasure'];mapEls.forEach((el,i)=>{el.textContent=(state.level>i?'[✓]':'[ ]')+' Level '+(i+1)+' — '+lbls[i];if(state.level>i)el.classList.add('done');else el.classList.remove('done');});}
function checkLevels(){
if(state.level===1 && state.cwd==='/vault/entrance')state.level=2;
if(state.level===2 && fs['/vault/entrance'].includes('key.txt') && !fs['/vault/entrance'].includes('alarm.txt'))state.level=3;
if(state.level===3 && state.cwd==='/vault/documents' && fs['/vault/documents'].includes('map.txt'))state.level=4;
if(state.level===4 && state.cwd==='/vault/chamber' && state.filePermissions['/vault/chamber/disable.sh']==='-rwxr-xr-x')state.level=5;
if(state.level===5 && state.cwd==='/home/thief/safehouse' && fs['/home/thief/safehouse'].includes('treasure.dat'))state.level=6;
updateUI();
}

function runCommand(line){
const raw=line.trim();if(!raw)return;pushLine('$ '+raw,'command');
const parts=raw.split(/\s+/),cmd=parts[0],args=parts.slice(1);
switch(cmd){
case'help':pushLine('Commands: help,pwd,ls,cd,touch,rm,cat,chmod,scp','command');break;
case'pwd':pushLine(state.cwd);break;
case'ls':{let tgt=args[0]?normalizePath(args[0]):state.cwd;if(fs[tgt])pushLine(fs[tgt].join('  '));else pushLine(`ls: no such file '${args[0]||'.'}'`,'error');}break;
case'cd':{if(!args[0]){pushLine('cd: missing operand','error');break;}let tgt=normalizePath(args[0]);if(fs[tgt]){state.cwd=tgt;pushLine(state.cwd);checkLevels();}else pushLine(`cd: no such file '${args[0]}'`,'error');}break;
case'touch':{if(!args[0]){pushLine('touch: missing operand','error');break;}let f=normalizePath(args[0]);let dir=f.split('/').slice(0,-1).join('/')||'/';fs[dir]=fs[dir]||[];if(!fs[dir].includes(f.split('/').pop()))fs[dir].push(f.split('/').pop());checkLevels();}break;
case'rm':{if(!args[0]){pushLine('rm: missing operand','error');break;}let f=normalizePath(args[0]);let dir=f.split('/').slice(0,-1).join('/')||'/';if(fs[dir])fs[dir]=fs[dir].filter(x=>x!==f.split('/').pop());checkLevels();}break;
case'cat':{if(!args[0]){pushLine('cat: missing operand','error');break;}let f=normalizePath(args[0]);if(fileContents[f])pushLine(fileContents[f]);else pushLine(`cat: no such file '${args[0]}'`,'error');}break;
case'chmod':{if(args.length<2){pushLine('chmod: missing operand','error');break;}let perm=args[0],f=normalizePath(args[1]);state.filePermissions[f]=perm;checkLevels();}break;
case'scp':{if(args.length<2){pushLine('scp: missing operand','error');break;}let f=normalizePath(args[0]),dest=normalizePath(args[1]);if(fs[dest]){fs[dest].push(f.split('/').pop());pushLine(`Copied ${f} -> ${dest}`,'success');checkLevels();}else pushLine(`scp: destination '${args[1]}' not found`,'error');}break;
default:pushLine(`${cmd}: command not found`,'error');}
}

pushLine('Welcome to Linux Treasure Hunt!');pushLine('Type help to see commands.','command');
document.getElementById('btn-help').addEventListener('click',()=>{runCommand('help');});
document.getElementById('btn-clear').addEventListener('click',()=>{term.innerHTML='';pushLine('');});
document.getElementById('form').addEventListener('submit',e=>{e.preventDefault();runCommand(input.value);input.value='';input.focus();});
})();
</script>
</body>
</html>
